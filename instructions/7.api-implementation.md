# 7. 核心 API 实现顺序（建议）

1. **模型设计**
   - 在 `app/models.py` 定义 `User / Environment / TrafficFile / ReplayTask / ReplayResult`
   - 保持字段与索引一致（如 `status` 加索引）
2. **Schemas（可选）**
   - 在 `app/schemas/` 使用 Pydantic 定义请求/响应模型，保证接口一致性
3. **任务 API**
   - `GET /api/v1/tasks/`：分页 + 状态过滤 + 搜索
   - `POST /api/v1/tasks/`：创建任务 → Celery 异步执行
   - `GET /api/v1/tasks/{id}`：任务详情（含环境、流量信息）
   - `GET /api/v1/tasks/{id}/results`：结果分页 + diff 过滤
4. **流量 API**
   - `POST /api/v1/traffic/upload`：分块写入 + 元数据入库
   - `GET /api/v1/traffic/`：分页、搜索
5. **环境 API**
   - `POST /api/v1/environments/`：创建环境
   - `GET /api/v1/environments/`：分页列表
6. **系统 API（可选）**
   - `/health`、`/metrics`、`/version` 等辅助接口
7. **测试**
   - 使用 `pytest` + `TestClient` 为关键 API 写基础测试
   - Mock 外部依赖（如 Celery、Redis）或使用测试容器
