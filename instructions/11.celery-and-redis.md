# 11. Celery 与 Redis 配置

1. 安装 Redis（如使用 Docker，可直接使用 compose 中的 redis 服务）
2. 在 `backend/app/celery_app.py` 中：
   ```python
   from celery import Celery
   from app.config import settings

   celery_app = Celery(
       "replay_platform",
       broker=settings.CELERY_BROKER_URL,
       backend=settings.CELERY_RESULT_BACKEND,
   )
   celery_app.conf.update(task_serializer="json", result_serializer="json")
   ```
3. 在 `.env` 中添加：
   ```
   CELERY_BROKER_URL=redis://redis:6379/0
   CELERY_RESULT_BACKEND=redis://redis:6379/1
   ```
4. 创建 Worker 启动命令
   ```bash
   celery -A app.celery_app.celery_app worker --loglevel=info
   ```
5. 将回放逻辑写在 `app/services/replay_engine.py` 中，并通过 `celery_app.send_task` 触发
