# 14. 认证与安全加固

1. 账号体系
   - `User` 模型：用户名、邮箱、hashed_password、角色
   - 使用 `passlib` 进行密码哈希
2. JWT 认证
   - 登录接口：校验密码 → 颁发 JWT（含用户ID、角色、过期时间）
   - 保护接口：依赖 `get_current_user`，验证 Token、检查权限
3. CORS 配置
   - allow_origins 从环境变量读取；生产环境仅允许正式前端域名
4. HTTPS
   - 开发阶段可用 http；生产务必在 Nginx/网关层配置 TLS
5. 数据脱敏与日志
   - 日志中避免打印 Token/密码/敏感请求体
   - 对上传流量中的个人信息进行脱敏
