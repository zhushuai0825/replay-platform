# 8. 前端功能联调（当前实现说明）

> 下面内容与 `frontend/src/` 现有代码完全同步，便于零基础阅读和后续扩展。

---

## 1. 环境变量

- 在 `frontend/.env` 或 `.env.local` 中配置：
  ```
  VITE_API_BASE_URL=http://localhost:8000
  ```
- 该值会在 axios 中作为默认 `baseURL`，若后端部署在其它地址只需修改这里。

---

## 2. Axios 客户端 `src/api/index.js`

```javascript
import axios from 'axios'

const api = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000',
  timeout: 30000,
  headers: { 'Content-Type': 'application/json' },
})

api.interceptors.request.use((config) => {
  const token = localStorage.getItem('token')
  if (token) config.headers.Authorization = `Bearer ${token}`
  return config
})

api.interceptors.response.use(
  (response) => response.data,
  (error) => {
    console.error('API Error:', error.response?.data || error.message)
    return Promise.reject(error)
  }
)

export default api
```

- 统一超时时间 30 秒
- 响应拦截器直接返回 `data`，因此视图层拿到的就是后端返回体

---

## 3. 路由配置 `src/router/index.js`

```javascript
import { createRouter, createWebHistory } from 'vue-router'
import Dashboard from '@/views/Dashboard.vue'
import Tasks from '@/views/Tasks.vue'
import Traffic from '@/views/Traffic.vue'
import Environments from '@/views/Environments.vue'

const routes = [
  { path: '/', redirect: '/dashboard' },
  { path: '/dashboard', component: Dashboard },
  { path: '/tasks', component: Tasks },
  { path: '/traffic', component: Traffic },
  { path: '/environments', component: Environments },
]

const router = createRouter({
  history: createWebHistory(),
  routes,
})

export default router
```

- 当前只有 4 个页面路由，尚未做权限控制与 404 处理

---

## 4. 入口文件 `src/main.js`

```javascript
import { createApp } from 'vue'
import './style.css'
import App from './App.vue'
import router from './router'

const app = createApp(App)
app.use(router)
app.mount('#app')
```

- 暂未集成 UI 库/Pinia；可按文档 #17 进行扩展

---

## 5. 视图占位（以 `src/views/Tasks.vue` 为例）

```vue
<template>
  <div class="tasks">
    <h2>任务管理</h2>
    <p>这里展示任务列表、搜索、筛选等功能。</p>
  </div>
</template>

<script setup>
// TODO: 将来在这里引入 api 并请求任务列表
</script>

<style scoped>
.tasks { padding: 20px; }
</style>
```

- `Dashboard.vue`、`Traffic.vue`、`Environments.vue` 目前同样是占位内容
- 把结构先搭好，后续再逐步接入真正的数据与操作

---

## 6. Vite 配置 `vite.config.js`

```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
  server: {
    port: 3000,
    host: 'localhost',
    strictPort: false,
  },
})
```

- `@` 指向 `src` 目录，所有导入都可写 `@/views/Tasks.vue`
- 开发服务器默认跑在 `http://localhost:3000`

---

## 7. 启动与联调

```bash
# 1. 启动后端（另一个终端）
cd backend
uvicorn app.main:app --reload

# 2. 启动前端
cd frontend
npm install    # 首次需要
npm run dev
```

- 浏览器访问 `http://localhost:3000`
- 打开 DevTools 的 Console/Network 观察请求与日志

---

## 8. 后续扩展建议

1. 在 `Tasks.vue` 中导入 `api` 调用 `/api/v1/tasks/`，用 `ref` 保存任务列表
2. 在 `Traffic.vue` 加入上传表单（参考文档 #12 的表单/上传逻辑）
3. 引入 UI 库（Element Plus）与 Pinia（见文档 #17），统一界面风格
4. 待后端完成更多 API，再逐步完善前端表格、表单、详情页
