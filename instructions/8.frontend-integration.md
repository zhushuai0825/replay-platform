# 8. 前端功能联调步骤

1. **配置环境变量**
   - 在 `frontend/.env` 中设置：
     ```
     VITE_API_BASE_URL=http://localhost:8000
     ```
   - 生产环境可改为 Nginx 反向代理地址。
2. **任务列表页面 (`src/views/Tasks.vue`)**
   - 从 `@/api` 获取 `/api/v1/tasks/` 数据，参数示例：
     ```javascript
     const params = { page, page_size, status, search }
     const res = await api.get('/api/v1/tasks/', { params })
     tasks.value = res.items
     total.value = res.total
     ```
   - Element Plus 表格列示例：ID、任务名称、状态、进度、操作按钮。
   - 分页组件绑定 `current-page`、`page-size`，在 `@current-change` 调用 `fetchTasks`。
3. **任务详情页面 (`src/views/TaskDetail.vue`)**
   - 通过路由参数 `taskId` 调用：
     - `GET /api/v1/tasks/{id}`
     - `GET /api/v1/tasks/{id}/results?page=1&page_size=20&status=diff`
   - 展示信息卡（任务名称、环境、创建时间、进度条）+ 结果列表 + diff 展示按钮。
4. **流量管理页面**
   - 上传：
     ```javascript
     const form = new FormData()
     form.append('file', selectedFile)
     await api.post('/api/v1/traffic/upload', form, { headers: { 'Content-Type': 'multipart/form-data' } })
     ```
   - 列表：`GET /api/v1/traffic/?page=1&page_size=10&search=xxx`
   - 展示原始文件名、大小、创建时间，并提供下载/查看按钮（可选）。
5. **环境管理页面**
   - 创建环境：表单字段 `name/base_url/headers/auth_config` → `POST /api/v1/environments/`
   - 列表：`GET /api/v1/environments/?page=1&page_size=10`
   - 用于创建任务时选择目标环境。
6. **状态管理与 UI**
   - 建议创建 Pinia store：
     ```javascript
     export const useTaskStore = defineStore('task', {
       state: () => ({ items: [], total: 0, page: 1, pageSize: 10, status: '', search: '' }),
       actions: { async fetchTasks() { ... } }
     })
     ```
   - UI 库：Element Plus（表格/分页/表单/对话框），统一主题与布局。
7. **联调注意事项**
   - 确保后端 CORS 允许当前前端域名
   - axios 错误统一处理（弹窗/通知）
   - 遇到跨域或 401：检查 Token、登录态、后端中间件顺序
   - 使用浏览器 Network/Console 面板定位请求与响应
